from Crypto.Util.number import inverse, long_to_bytes

n = 104563359048381699143496468528300829321521306245331798554377007275103972998601378376556492124892426136873242406351471061175987750363022542521321325668261386913655443065584684103176230987227084692097556823325293438051124142712170170514377020219744084768118447753920539811071475855581191681108997838285701231732792608341304550164618485623315581957742390073202563364482024282447492186708508872853311316987103347313894260441540810269428627730438803602782390088028634493217149
e = 3
c = 22173447507982960911932303942215828946579096431749344168425883346555707018887256668501896587126579327020547624703321173941608561985285845551871439566430301537973648495315007191581885076622052971365174131117592676969402054047005773830470165154770264166089605718284693076512328242930429123374165191012691651443060028698753199068900992489379802683570833040343531655

# 1. φ(n) = (p-1)*(q-1)
phi = (p-1)*(q-1)

# 2. 求 d
d = inverse(e, phi)

# 3. 解密
m = pow(c, d, p*q)

# 4. 转回字节
flag = long_to_bytes(m)
print(flag)  # 这才是正确的 secret message
